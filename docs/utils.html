<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Utils å·¥å…·æ¨¡å— - è”é‚¦å­¦ä¹ æ¡†æ¶æ–‡æ¡£</title>
    <link rel="stylesheet" href="assets/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>ğŸš€ è”é‚¦å­¦ä¹ æ¡†æ¶</h2>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">é¦–é¡µ</a></li>
                <li><a href="core.html" class="nav-link">Core</a></li>
                <li><a href="communication.html" class="nav-link">Communication</a></li>
                <li><a href="aggregation.html" class="nav-link">Aggregation</a></li>
                <li><a href="data.html" class="nav-link">Data</a></li>
                <li><a href="models.html" class="nav-link">Models</a></li>
                <li><a href="execution-flow.html" class="nav-link">æ‰§è¡Œæµç¨‹</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <a href="index.html" class="back-button">â† è¿”å›é¦–é¡µ</a>
        
        <header class="hero">
            <h1>ğŸ› ï¸ Utils å·¥å…·æ¨¡å—</h1>
            <p class="hero-subtitle">è”é‚¦å­¦ä¹ å®éªŒçš„é…ç½®ç®¡ç†ã€æ‰§è¡Œæ§åˆ¶å’Œç»“æœå¤„ç†å·¥å…·é›†</p>
        </header>

        <div class="content-section">
            <h2>æ¨¡å—æ¦‚è¿°</h2>
            <p>Utils æ¨¡å—æ˜¯è”é‚¦å­¦ä¹ æ¡†æ¶çš„å·¥å…·é›†åˆï¼Œæä¾›äº†å®éªŒé…ç½®ç®¡ç†ã€å®éªŒæ‰§è¡Œã€ç»“æœå¤„ç†ã€æ—¥å¿—è®°å½•ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚è¯¥æ¨¡å—é€šè¿‡æ¨¡å—åŒ–è®¾è®¡ï¼Œå°†å¤æ‚çš„å®éªŒæµç¨‹åˆ†è§£ä¸ºå¯å¤ç”¨çš„å·¥å…·ç»„ä»¶ï¼Œå¤§å¤§ç®€åŒ–äº†è”é‚¦å­¦ä¹ å®éªŒçš„å¼€å‘å’Œæ‰§è¡Œã€‚</p>
            
            <div class="info-box">
                <strong>æ ¸å¿ƒä»·å€¼ï¼š</strong> æä¾›å®Œæ•´çš„å®éªŒç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œä»é…ç½®è§£æåˆ°ç»“æœåˆ†æçš„ä¸€ç«™å¼å·¥å…·æ”¯æŒã€‚
            </div>
        </div>

        <div class="content-section">
            <h2>ğŸ“ æ–‡ä»¶ç»“æ„</h2>
            <pre><code>utils/
â”œâ”€â”€ __init__.py                  # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ config_manager.py            # é…ç½®æ–‡ä»¶ç®¡ç†å’ŒéªŒè¯
â”œâ”€â”€ experiment_runner.py         # å®éªŒæ‰§è¡Œæ§åˆ¶å™¨
â”œâ”€â”€ results_handler.py           # å®éªŒç»“æœå¤„ç†å’Œåˆ†æ
â”œâ”€â”€ model_factory.py             # æ¨¡å‹å·¥å‚æ¨¡å¼å®ç°
â”œâ”€â”€ optimizer_factory.py         # ä¼˜åŒ–å™¨å·¥å‚æ¨¡å¼å®ç°
â”œâ”€â”€ device_manager.py            # è®¾å¤‡ï¼ˆCPU/GPUï¼‰ç®¡ç†
â”œâ”€â”€ evaluation_manager.py        # æ¨¡å‹è¯„ä¼°ç®¡ç†å™¨
â”œâ”€â”€ dataset_stats.py             # æ•°æ®é›†ç»Ÿè®¡å·¥å…·
â””â”€â”€ wandb_logger.py              # WandB æ—¥å¿—é›†æˆ</code></pre>
        </div>

        <div class="content-section">
            <h2>âš™ï¸ ConfigManager é…ç½®ç®¡ç†å™¨</h2>
            <p>è´Ÿè´£YAMLé…ç½®æ–‡ä»¶çš„åŠ è½½ã€éªŒè¯å’Œå‘½ä»¤è¡Œå‚æ•°è¦†ç›–ï¼Œç¡®ä¿å®éªŒé…ç½®çš„æ­£ç¡®æ€§å’Œçµæ´»æ€§ã€‚</p>
            
            <h3>æ ¸å¿ƒåŠŸèƒ½</h3>
            <ul class="method-list">
                <li>
                    <div class="method-signature">load_config(config_file: str) -> Dict[str, Any]</div>
                    <div class="method-description">åŠ è½½YAMLé…ç½®æ–‡ä»¶ï¼Œæ”¯æŒç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„</div>
                </li>
                <li>
                    <div class="method-signature">_validate_config(config: Dict[str, Any])</div>
                    <div class="method-description">éªŒè¯é…ç½®æ–‡ä»¶å®Œæ•´æ€§ï¼Œæ£€æŸ¥å¿…éœ€çš„é…ç½®é¡¹å’Œæ•°æ®é›†é…ç½®</div>
                </li>
                <li>
                    <div class="method-signature">override_config(config: Dict[str, Any], args: argparse.Namespace) -> Dict[str, Any]</div>
                    <div class="method-description">ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°è¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®</div>
                </li>
                <li>
                    <div class="method-signature">create_parser() -> argparse.ArgumentParser</div>
                    <div class="method-description">åˆ›å»ºå‘½ä»¤è¡Œå‚æ•°è§£æå™¨ï¼Œæ”¯æŒå¸¸ç”¨å‚æ•°å¿«é€Ÿè¦†ç›–</div>
                </li>
            </ul>

            <h3>æ”¯æŒçš„å‘½ä»¤è¡Œå‚æ•°</h3>
            <table class="property-table">
                <tr>
                    <th>å‚æ•°å</th>
                    <th>é…ç½®è·¯å¾„</th>
                    <th>æè¿°</th>
                </tr>
                <tr>
                    <td>--rounds</td>
                    <td>experiment.rounds</td>
                    <td>è”é‚¦å­¦ä¹ è®­ç»ƒè½®æ•°</td>
                </tr>
                <tr>
                    <td>--num-clients</td>
                    <td>client.num_clients</td>
                    <td>å‚ä¸è®­ç»ƒçš„å®¢æˆ·ç«¯æ•°é‡</td>
                </tr>
                <tr>
                    <td>--local-epochs</td>
                    <td>client.local_epochs</td>
                    <td>å®¢æˆ·ç«¯æœ¬åœ°è®­ç»ƒè½®æ•°</td>
                </tr>
                <tr>
                    <td>--learning-rate</td>
                    <td>client.learning_rate, model.learning_rate</td>
                    <td>å­¦ä¹ ç‡ï¼ˆåŒæ—¶è®¾ç½®å®¢æˆ·ç«¯å’Œæ¨¡å‹ï¼‰</td>
                </tr>
                <tr>
                    <td>--batch-size</td>
                    <td>data.batch_size</td>
                    <td>è®­ç»ƒæ‰¹å¤§å°</td>
                </tr>
                <tr>
                    <td>--data-dir</td>
                    <td>data.data_dir</td>
                    <td>æ•°æ®é›†å­˜å‚¨ç›®å½•</td>
                </tr>
            </table>

            <h3>é…ç½®éªŒè¯è§„åˆ™</h3>
            <ul>
                <li><strong>å¿…éœ€èŠ‚ç‚¹ï¼š</strong> experiment, client, data, model</li>
                <li><strong>å®¢æˆ·ç«¯æ•°æ®é›†ï¼š</strong> æ¯ä¸ªå®¢æˆ·ç«¯å¿…é¡»é…ç½®è‡³å°‘ä¸€ä¸ªæ•°æ®é›†</li>
                <li><strong>æ•°æ®é›†å­˜åœ¨æ€§ï¼š</strong> å®¢æˆ·ç«¯é…ç½®çš„æ•°æ®é›†å¿…é¡»åœ¨data.datasetsä¸­å®šä¹‰</li>
                <li><strong>æ•°é‡ä¸€è‡´æ€§ï¼š</strong> client_datasetsé…ç½®æ•°é‡å¿…é¡»ä¸num_clientsåŒ¹é…</li>
            </ul>
        </div>

        <div class="content-section">
            <h2>ğŸš€ ExperimentRunner å®éªŒæ‰§è¡Œå™¨</h2>
            <p>è”é‚¦å­¦ä¹ å®éªŒçš„æ ¸å¿ƒæ§åˆ¶å™¨ï¼Œè´Ÿè´£å®éªŒçš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€è®­ç»ƒæ‰§è¡Œå’Œç»“æœæ”¶é›†ã€‚</p>
            
            <h3>ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3>
            <div class="architecture-content">
                <div class="architecture-diagram">
                    <div class="arch-layer">
                        <h4>1. å®éªŒåˆå§‹åŒ–</h4>
                        <div class="arch-components">
                            <span>éšæœºç§å­è®¾ç½®</span>
                            <span>è®¾å¤‡æ£€æµ‹</span>
                            <span>WandBé…ç½®</span>
                        </div>
                    </div>
                    <div class="arch-layer">
                        <h4>2. ç»„ä»¶è®¾ç½®</h4>
                        <div class="arch-components">
                            <span>æ•°æ®åŠ è½½å™¨</span>
                            <span>æ¨¡å‹å’ŒæœåŠ¡å™¨</span>
                            <span>å®¢æˆ·ç«¯åˆ›å»º</span>
                        </div>
                    </div>
                    <div class="arch-layer">
                        <h4>3. è®­ç»ƒæ‰§è¡Œ</h4>
                        <div class="arch-components">
                            <span>è”é‚¦è½®æ¬¡</span>
                            <span>å®¢æˆ·ç«¯è®­ç»ƒ</span>
                            <span>æœåŠ¡å™¨èšåˆ</span>
                        </div>
                    </div>
                    <div class="arch-layer">
                        <h4>4. ç»“æœå¤„ç†</h4>
                        <div class="arch-components">
                            <span>æŒ‡æ ‡æ”¶é›†</span>
                            <span>æ—¥å¿—è®°å½•</span>
                            <span>ç»“æœä¿å­˜</span>
                        </div>
                    </div>
                </div>
                
                <div class="architecture-description">
                    <h4>æ‰§è¡Œç‰¹ç‚¹</h4>
                    <ul>
                        <li><strong>è‡ªåŠ¨åŒ–æµç¨‹ï¼š</strong> ä¸€é”®å¼å®éªŒæ‰§è¡Œ</li>
                        <li><strong>è¿›åº¦ç›‘æ§ï¼š</strong> å®æ—¶æ˜¾ç¤ºè®­ç»ƒè¿›åº¦</li>
                        <li><strong>å¼‚å¸¸å¤„ç†ï¼š</strong> ä¼˜é›…å¤„ç†è®­ç»ƒå¼‚å¸¸</li>
                        <li><strong>ç»“æœè®°å½•ï¼š</strong> å®Œæ•´çš„å®éªŒæ—¥å¿—</li>
                    </ul>
                </div>
            </div>

            <h3>æ ¸å¿ƒæ–¹æ³•</h3>
            <ul class="method-list">
                <li>
                    <div class="method-signature">__init__(config: Dict[str, Any])</div>
                    <div class="method-description">åˆå§‹åŒ–å®éªŒæ‰§è¡Œå™¨ï¼Œè§£æé…ç½®å¹¶è®¾ç½®åŸºç¡€ç¯å¢ƒ</div>
                </li>
                <li>
                    <div class="method-signature">run_experiment() -> Dict[str, Any]</div>
                    <div class="method-description">æ‰§è¡Œå®Œæ•´çš„è”é‚¦å­¦ä¹ å®éªŒï¼Œè¿”å›å®éªŒç»“æœ</div>
                </li>
                <li>
                    <div class="method-signature">setup_data()</div>
                    <div class="method-description">è®¾ç½®æ•°æ®åŠ è½½å™¨ï¼Œä¸ºæ¯ä¸ªå®¢æˆ·ç«¯åˆ†é…æ•°æ®</div>
                </li>
                <li>
                    <div class="method-signature">setup_server()</div>
                    <div class="method-description">åˆ›å»ºå…¨å±€æ¨¡å‹å’Œè”é‚¦å­¦ä¹ æœåŠ¡å™¨</div>
                </li>
                <li>
                    <div class="method-signature">setup_clients()</div>
                    <div class="method-description">åˆ›å»ºè”é‚¦å­¦ä¹ å®¢æˆ·ç«¯åˆ—è¡¨</div>
                </li>
                <li>
                    <div class="method-signature">run_federated_round(round_num: int) -> Dict[str, float]</div>
                    <div class="method-description">æ‰§è¡Œå•è½®è”é‚¦å­¦ä¹ ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯è®­ç»ƒå’ŒæœåŠ¡å™¨èšåˆ</div>
                </li>
            </ul>

            <h3>å®éªŒé…ç½®æ”¯æŒ</h3>
            <table class="property-table">
                <tr>
                    <th>é…ç½®é¡¹</th>
                    <th>åŠŸèƒ½</th>
                    <th>é»˜è®¤å€¼</th>
                </tr>
                <tr>
                    <td>experiment.rounds</td>
                    <td>è”é‚¦å­¦ä¹ è½®æ•°</td>
                    <td>10</td>
                </tr>
                <tr>
                    <td>experiment.seed</td>
                    <td>éšæœºç§å­</td>
                    <td>42</td>
                </tr>
                <tr>
                    <td>evaluation.evaluate_every</td>
                    <td>è¯„ä¼°é—´éš”</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>wandb.enabled</td>
                    <td>å¯ç”¨WandBæ—¥å¿—</td>
                    <td>false</td>
                </tr>
            </table>
        </div>

        <div class="content-section">
            <h2>ğŸ“Š ResultsHandler ç»“æœå¤„ç†å™¨</h2>
            <p>è´Ÿè´£å®éªŒç»“æœçš„æ”¶é›†ã€åˆ†æå’Œå±•ç¤ºï¼Œæä¾›ç»Ÿä¸€çš„ç»“æœå¤„ç†æ¥å£ã€‚</p>
            
            <h3>æ ¸å¿ƒåŠŸèƒ½</h3>
            <ul class="method-list">
                <li>
                    <div class="method-signature">print_experiment_summary(results: Dict[str, Any])</div>
                    <div class="method-description">æ‰“å°å®éªŒç»“æœæ‘˜è¦ï¼ŒåŒ…æ‹¬æœ€ç»ˆæ€§èƒ½å’Œè®­ç»ƒç»Ÿè®¡</div>
                </li>
                <li>
                    <div class="method-signature">save_results(results: Dict[str, Any], filepath: str)</div>
                    <div class="method-description">ä¿å­˜å®éªŒç»“æœåˆ°JSONæ–‡ä»¶</div>
                </li>
                <li>
                    <div class="method-signature">load_results(filepath: str) -> Dict[str, Any]</div>
                    <div class="method-description">ä»æ–‡ä»¶åŠ è½½å®éªŒç»“æœ</div>
                </li>
                <li>
                    <div class="method-signature">compare_experiments(results_list: List[Dict]) -> pd.DataFrame</div>
                    <div class="method-description">æ¯”è¾ƒå¤šä¸ªå®éªŒç»“æœï¼Œç”Ÿæˆå¯¹æ¯”è¡¨æ ¼</div>
                </li>
            </ul>

            <h3>ç»“æœæ•°æ®ç»“æ„</h3>
            <pre><code>{
    "experiment_config": {
        "name": "MNIST_FedAvg",
        "rounds": 10,
        "num_clients": 5
    },
    "final_metrics": {
        "global_accuracy": 0.9542,
        "global_loss": 0.1234
    },
    "training_history": {
        "round_metrics": [...],
        "client_metrics": [...]
    },
    "execution_time": 123.45
}</code></pre>
        </div>

        <div class="content-section">
            <h2>ğŸ­ ModelFactory æ¨¡å‹å·¥å‚</h2>
            <p>å®ç°æ¨¡å‹åˆ›å»ºçš„å·¥å‚æ¨¡å¼ï¼Œæ”¯æŒå¤šç§æ¨¡å‹ç±»å‹çš„ç»Ÿä¸€åˆ›å»ºæ¥å£ã€‚</p>
            
            <h3>æ”¯æŒçš„æ¨¡å‹ç±»å‹</h3>
            <table class="property-table">
                <tr>
                    <th>æ¨¡å‹ç±»å‹</th>
                    <th>ç±»å</th>
                    <th>é€‚ç”¨åœºæ™¯</th>
                </tr>
                <tr>
                    <td>cnn</td>
                    <td>CNNModel</td>
                    <td>å›¾åƒåˆ†ç±»ä»»åŠ¡</td>
                </tr>
                <tr>
                    <td>clip</td>
                    <td>CLIPModel</td>
                    <td>å¤šæ¨¡æ€å­¦ä¹ </td>
                </tr>
                <tr>
                    <td>linear</td>
                    <td>LinearModel</td>
                    <td>ç®€å•åˆ†ç±»ä»»åŠ¡</td>
                </tr>
            </table>

            <h3>ä½¿ç”¨ç¤ºä¾‹</h3>
            <pre><code># åˆ›å»ºä¸åŒç±»å‹çš„æ¨¡å‹
cnn_model = ModelFactory.create_model({
    'type': 'cnn',
    'learning_rate': 0.001
})

clip_model = ModelFactory.create_model({
    'type': 'clip',
    'model_name': 'openai/clip-vit-base-patch32'
})</code></pre>
        </div>

        <div class="content-section">
            <h2>âš¡ OptimizerFactory ä¼˜åŒ–å™¨å·¥å‚</h2>
            <p>æä¾›ç»Ÿä¸€çš„ä¼˜åŒ–å™¨åˆ›å»ºæ¥å£ï¼Œæ”¯æŒAdamWç­‰ä¸»æµä¼˜åŒ–å™¨ã€‚</p>
            
            <h3>æ ¸å¿ƒæ–¹æ³•</h3>
            <ul class="method-list">
                <li>
                    <div class="method-signature">create_optimizer(parameters, config: Dict[str, Any])</div>
                    <div class="method-description">æ ¹æ®é…ç½®åˆ›å»ºä¼˜åŒ–å™¨å®ä¾‹</div>
                </li>
                <li>
                    <div class="method-signature">get_default_config() -> Dict[str, Any]</div>
                    <div class="method-description">è·å–é»˜è®¤ä¼˜åŒ–å™¨é…ç½®</div>
                </li>
            </ul>

            <h3>é»˜è®¤é…ç½®</h3>
            <pre><code>{
    'type': 'AdamW',
    'lr': 0.001,
    'weight_decay': 0.01,
    'betas': (0.9, 0.999),
    'eps': 1e-8
}</code></pre>
        </div>

        <div class="content-section">
            <h2>ğŸ–¥ï¸ DeviceManager è®¾å¤‡ç®¡ç†å™¨</h2>
            <p>è‡ªåŠ¨æ£€æµ‹å’Œç®¡ç†è®¡ç®—è®¾å¤‡ï¼ˆCPU/GPUï¼‰ï¼Œæä¾›è®¾å¤‡ç›¸å…³çš„å·¥å…·å‡½æ•°ã€‚</p>
            
            <h3>æ ¸å¿ƒåŠŸèƒ½</h3>
            <ul class="method-list">
                <li>
                    <div class="method-signature">get_device() -> torch.device</div>
                    <div class="method-description">è‡ªåŠ¨æ£€æµ‹å¹¶è¿”å›æœ€ä½³å¯ç”¨è®¾å¤‡</div>
                </li>
                <li>
                    <div class="method-signature">move_model_to_device(model, device) -> model</div>
                    <div class="method-description">å°†æ¨¡å‹ç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡</div>
                </li>
                <li>
                    <div class="method-signature">move_tensors_to_device(*tensors, device) -> Tuple</div>
                    <div class="method-description">å°†å¼ é‡ç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡</div>
                </li>
                <li>
                    <div class="method-signature">print_device_info()</div>
                    <div class="method-description">æ‰“å°è®¾å¤‡ä¿¡æ¯å’ŒGPUçŠ¶æ€</div>
                </li>
            </ul>

            <h3>è®¾å¤‡æ£€æµ‹é€»è¾‘</h3>
            <pre><code>def get_device():
    if torch.cuda.is_available():
        return torch.device('cuda')
    elif torch.backends.mps.is_available():  # Apple Silicon
        return torch.device('mps')
    else:
        return torch.device('cpu')</code></pre>
        </div>

        <div class="content-section">
            <h2>ğŸ“ˆ EvaluationManager è¯„ä¼°ç®¡ç†å™¨</h2>
            <p>ç»Ÿä¸€ç®¡ç†å®¢æˆ·ç«¯å’Œå…¨å±€æ¨¡å‹çš„è¯„ä¼°è¿‡ç¨‹ï¼Œæä¾›è¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡ã€‚</p>
            
            <h3>è¯„ä¼°åŠŸèƒ½</h3>
            <ul class="method-list">
                <li>
                    <div class="method-signature">evaluate_clients(clients: List, round_num: int) -> Dict</div>
                    <div class="method-description">è¯„ä¼°æ‰€æœ‰å®¢æˆ·ç«¯çš„æœ¬åœ°æ¨¡å‹æ€§èƒ½</div>
                </li>
                <li>
                    <div class="method-signature">evaluate_global_model(server, test_dataloader, round_num: int) -> Dict</div>
                    <div class="method-description">è¯„ä¼°å…¨å±€æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„æ€§èƒ½</div>
                </li>
                <li>
                    <div class="method-signature">create_test_dataloader(dataset_configs: List) -> DataLoader</div>
                    <div class="method-description">åˆ›å»ºç»Ÿä¸€çš„æµ‹è¯•æ•°æ®åŠ è½½å™¨</div>
                </li>
            </ul>

            <h3>è¯„ä¼°æŒ‡æ ‡</h3>
            <ul>
                <li><strong>å®¢æˆ·ç«¯æŒ‡æ ‡ï¼š</strong> æœ¬åœ°æ¨¡å‹åœ¨å®¢æˆ·ç«¯æ•°æ®ä¸Šçš„æŸå¤±å’Œå‡†ç¡®ç‡</li>
                <li><strong>å…¨å±€æŒ‡æ ‡ï¼š</strong> å…¨å±€æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„æ•´ä½“æ€§èƒ½</li>
                <li><strong>èšåˆæŒ‡æ ‡ï¼š</strong> å®¢æˆ·ç«¯æ€§èƒ½çš„ç»Ÿè®¡æ‘˜è¦ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ç­‰ï¼‰</li>
            </ul>
        </div>

        <div class="content-section">
            <h2>ğŸ“Š DatasetStats æ•°æ®é›†ç»Ÿè®¡</h2>
            <p>åˆ†æå’Œç»Ÿè®¡æ•°æ®é›†åœ¨å®¢æˆ·ç«¯é—´çš„åˆ†å¸ƒæƒ…å†µï¼Œå¸®åŠ©ç†è§£è”é‚¦å­¦ä¹ çš„æ•°æ®å¼‚æ„æ€§ã€‚</p>
            
            <h3>ç»Ÿè®¡åŠŸèƒ½</h3>
            <ul class="method-list">
                <li>
                    <div class="method-signature">count_clients_per_dataset(config: Dict) -> Tuple[Dict, Dict]</div>
                    <div class="method-description">ç»Ÿè®¡æ¯ä¸ªæ•°æ®é›†è¢«å¤šå°‘ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨</div>
                </li>
            </ul>

            <h3>ç»Ÿè®¡è¾“å‡ºç¤ºä¾‹</h3>
            <pre><code># è¾“å‡ºç¤ºä¾‹
æ•°æ®é›†ç»Ÿè®¡ä¿¡æ¯:
- mnist: è¢« 8 ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨
- cifar10: è¢« 3 ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨

å®¢æˆ·ç«¯è¯¦ç»†åˆ†å¸ƒ:
- mnist: client_0, client_1, client_2, client_3, client_4, client_5, client_6, client_7
- cifar10: client_2, client_3, client_8</code></pre>
        </div>

        <div class="content-section">
            <h2>ğŸ“ WandBLogger æ—¥å¿—é›†æˆ</h2>
            <p>é›†æˆWeights & Biases (WandB) è¿›è¡Œå®éªŒè·Ÿè¸ªå’Œå¯è§†åŒ–ã€‚</p>
            
            <h3>æ—¥å¿—åŠŸèƒ½</h3>
            <ul class="method-list">
                <li>
                    <div class="method-signature">init_wandb(config: Dict[str, Any])</div>
                    <div class="method-description">åˆå§‹åŒ–WandBé¡¹ç›®å’Œå®éªŒè·Ÿè¸ª</div>
                </li>
                <li>
                    <div class="method-signature">log_client_metrics(client_id: str, round_num: int, loss: float, accuracy: float)</div>
                    <div class="method-description">è®°å½•å®¢æˆ·ç«¯è®­ç»ƒæŒ‡æ ‡</div>
                </li>
                <li>
                    <div class="method-signature">log_global_metrics(round_num: int, metrics: Dict[str, float])</div>
                    <div class="method-description">è®°å½•å…¨å±€æ¨¡å‹è¯„ä¼°æŒ‡æ ‡</div>
                </li>
                <li>
                    <div class="method-signature">finish_wandb()</div>
                    <div class="method-description">ç»“æŸWandBå®éªŒè·Ÿè¸ª</div>
                </li>
            </ul>

            <h3>WandBé…ç½®</h3>
            <pre><code># é…ç½®æ–‡ä»¶ä¸­çš„WandBè®¾ç½®
wandb:
  enabled: true
  project: "federated_learning"
  entity: "your_team"
  tags: ["fedavg", "mnist"]
  notes: "å®éªŒæè¿°"</code></pre>
        </div>

        <div class="content-section">
            <h2>ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹</h2>
            
            <h3>å®Œæ•´å®éªŒæµç¨‹</h3>
            <pre><code>#!/usr/bin/env python3
from utils.config_manager import ConfigManager
from utils.experiment_runner import ExperimentRunner
from utils.results_handler import ResultsHandler

def main():
    # 1. é…ç½®ç®¡ç†
    config_manager = ConfigManager()
    parser = config_manager.create_parser()
    args = parser.parse_args()
    
    # åŠ è½½å’Œè¦†ç›–é…ç½®
    config = config_manager.load_config(args.config)
    config = config_manager.override_config(config, args)
    
    # 2. æ‰§è¡Œå®éªŒ
    experiment_runner = ExperimentRunner(config)
    results = experiment_runner.run_experiment()
    
    # 3. å¤„ç†ç»“æœ
    ResultsHandler.print_experiment_summary(results)
    ResultsHandler.save_results(results, "experiment_results.json")

if __name__ == '__main__':
    main()</code></pre>

            <h3>è‡ªå®šä¹‰å®éªŒæ§åˆ¶</h3>
            <pre><code>class CustomExperimentRunner(ExperimentRunner):
    """è‡ªå®šä¹‰å®éªŒæ‰§è¡Œå™¨"""
    
    def run_federated_round(self, round_num):
        """é‡å†™è”é‚¦è½®æ¬¡æ‰§è¡Œé€»è¾‘"""
        print(f"å¼€å§‹ç¬¬ {round_num + 1} è½®è”é‚¦å­¦ä¹ ")
        
        # è‡ªå®šä¹‰å®¢æˆ·ç«¯é‡‡æ ·ç­–ç•¥
        selected_clients = self.sample_clients(ratio=0.8)
        
        # æ‰§è¡Œå®¢æˆ·ç«¯è®­ç»ƒ
        client_updates = []
        for client in selected_clients:
            global_params = self.server.send_global_model()
            result = client.train(global_params)
            client_updates.append(result)
        
        # æœåŠ¡å™¨èšåˆ
        self.server.aggregate(client_updates)
        
        # è‡ªå®šä¹‰è¯„ä¼°é€»è¾‘
        if round_num % 2 == 0:  # æ¯ä¸¤è½®è¯„ä¼°ä¸€æ¬¡
            metrics = self.evaluation_manager.evaluate_global_model(
                self.server, self.test_dataloader, round_num
            )
            return metrics
        
        return {}
    
    def sample_clients(self, ratio=1.0):
        """å®¢æˆ·ç«¯é‡‡æ ·ç­–ç•¥"""
        import random
        num_selected = int(len(self.clients) * ratio)
        return random.sample(self.clients, num_selected)</code></pre>

            <h3>æ‰¹é‡å®éªŒæ‰§è¡Œ</h3>
            <pre><code>def run_batch_experiments():
    """æ‰¹é‡æ‰§è¡Œä¸åŒé…ç½®çš„å®éªŒ"""
    
    # å®éªŒé…ç½®å˜ä½“
    experiments = [
        {'config': 'configs/mnist.yaml', 'name': 'MNIST_Baseline'},
        {'config': 'configs/cifar10.yaml', 'name': 'CIFAR10_Baseline'},
        {'config': 'configs/multi_dataset.yaml', 'name': 'Multi_Dataset'}
    ]
    
    all_results = []
    
    for exp in experiments:
        print(f"è¿è¡Œå®éªŒ: {exp['name']}")
        
        # åŠ è½½é…ç½®
        config = ConfigManager.load_config(exp['config'])
        config['experiment']['name'] = exp['name']
        
        # æ‰§è¡Œå®éªŒ
        runner = ExperimentRunner(config)
        results = runner.run_experiment()
        
        # ä¿å­˜ç»“æœ
        results['experiment_name'] = exp['name']
        all_results.append(results)
        
        # ä¿å­˜å•ä¸ªå®éªŒç»“æœ
        ResultsHandler.save_results(
            results, 
            f"results/{exp['name']}_results.json"
        )
    
    # æ¯”è¾ƒå®éªŒç»“æœ
    comparison_df = ResultsHandler.compare_experiments(all_results)
    print("å®éªŒæ¯”è¾ƒç»“æœ:")
    print(comparison_df)</code></pre>

            <h3>é…ç½®æ–‡ä»¶åŠ¨æ€ç”Ÿæˆ</h3>
            <pre><code>def generate_experiment_configs():
    """åŠ¨æ€ç”Ÿæˆå®éªŒé…ç½®æ–‡ä»¶"""
    
    base_config = {
        'experiment': {
            'name': 'Auto_Generated',
            'rounds': 10,
            'seed': 42
        },
        'client': {
            'num_clients': 5,
            'local_epochs': 3,
            'learning_rate': 0.001
        },
        'data': {
            'batch_size': 32,
            'data_dir': './data',
            'datasets': {
                'mnist': {}
            }
        },
        'model': {
            'type': 'cnn',
            'learning_rate': 0.001
        }
    }
    
    # ç”Ÿæˆä¸åŒå®¢æˆ·ç«¯æ•°é‡çš„é…ç½®
    for num_clients in [3, 5, 10]:
        config = copy.deepcopy(base_config)
        config['experiment']['name'] = f'MNIST_{num_clients}_clients'
        config['client']['num_clients'] = num_clients
        
        # ç”Ÿæˆå®¢æˆ·ç«¯æ•°æ®é›†é…ç½®
        config['client']['client_datasets'] = {}
        for i in range(num_clients):
            config['client']['client_datasets'][f'client_{i}'] = ['mnist']
        
        # ä¿å­˜é…ç½®æ–‡ä»¶
        with open(f'configs/auto_mnist_{num_clients}.yaml', 'w') as f:
            yaml.dump(config, f, default_flow_style=False)</code></pre>
        </div>

        <div class="content-section">
            <h2>ğŸ”§ æ‰©å±•å·¥å…·æ¨¡å—</h2>
            
            <h3>æ·»åŠ æ–°çš„è¯„ä¼°æŒ‡æ ‡</h3>
            <pre><code># utils/advanced_metrics.py
import torch
import numpy as np
from sklearn.metrics import f1_score, precision_score, recall_score

class AdvancedMetrics:
    """é«˜çº§è¯„ä¼°æŒ‡æ ‡è®¡ç®—"""
    
    @staticmethod
    def compute_f1_score(predictions, targets, average='weighted'):
        """è®¡ç®—F1åˆ†æ•°"""
        pred_cpu = predictions.cpu().numpy()
        target_cpu = targets.cpu().numpy()
        return f1_score(target_cpu, pred_cpu, average=average)
    
    @staticmethod
    def compute_precision_recall(predictions, targets, average='weighted'):
        """è®¡ç®—ç²¾ç¡®ç‡å’Œå¬å›ç‡"""
        pred_cpu = predictions.cpu().numpy()
        target_cpu = targets.cpu().numpy()
        
        precision = precision_score(target_cpu, pred_cpu, average=average)
        recall = recall_score(target_cpu, pred_cpu, average=average)
        
        return precision, recall
    
    @staticmethod
    def compute_per_class_accuracy(predictions, targets, num_classes):
        """è®¡ç®—æ¯ä¸ªç±»åˆ«çš„å‡†ç¡®ç‡"""
        per_class_acc = []
        
        for class_idx in range(num_classes):
            class_mask = (targets == class_idx)
            if class_mask.sum() > 0:
                class_predictions = predictions[class_mask]
                class_targets = targets[class_mask]
                accuracy = (class_predictions == class_targets).float().mean()
                per_class_acc.append(accuracy.item())
            else:
                per_class_acc.append(0.0)
        
        return per_class_acc</code></pre>

            <h3>è‡ªå®šä¹‰å®éªŒè°ƒåº¦å™¨</h3>
            <pre><code># utils/experiment_scheduler.py
import time
import threading
from queue import Queue

class ExperimentScheduler:
    """å®éªŒè°ƒåº¦å™¨ï¼Œæ”¯æŒå¹¶è¡Œå®éªŒæ‰§è¡Œ"""
    
    def __init__(self, max_workers=2):
        self.max_workers = max_workers
        self.experiment_queue = Queue()
        self.results_storage = []
        self.workers = []
    
    def add_experiment(self, config_path, experiment_name):
        """æ·»åŠ å®éªŒåˆ°é˜Ÿåˆ—"""
        self.experiment_queue.put({
            'config_path': config_path,
            'name': experiment_name,
            'timestamp': time.time()
        })
    
    def worker_thread(self, worker_id):
        """å·¥ä½œçº¿ç¨‹æ‰§è¡Œå®éªŒ"""
        while True:
            try:
                experiment = self.experiment_queue.get(timeout=5)
                print(f"Worker {worker_id} å¼€å§‹æ‰§è¡Œ: {experiment['name']}")
                
                # æ‰§è¡Œå®éªŒ
                config = ConfigManager.load_config(experiment['config_path'])
                runner = ExperimentRunner(config)
                results = runner.run_experiment()
                
                # å­˜å‚¨ç»“æœ
                results['worker_id'] = worker_id
                results['experiment_name'] = experiment['name']
                self.results_storage.append(results)
                
                print(f"Worker {worker_id} å®Œæˆ: {experiment['name']}")
                self.experiment_queue.task_done()
                
            except Exception as e:
                print(f"Worker {worker_id} æ‰§è¡Œå¤±è´¥: {e}")
                break
    
    def start_workers(self):
        """å¯åŠ¨å·¥ä½œçº¿ç¨‹"""
        for i in range(self.max_workers):
            worker = threading.Thread(
                target=self.worker_thread, 
                args=(i,),
                daemon=True
            )
            worker.start()
            self.workers.append(worker)
    
    def wait_completion(self):
        """ç­‰å¾…æ‰€æœ‰å®éªŒå®Œæˆ"""
        self.experiment_queue.join()
        return self.results_storage</code></pre>
        </div>

        <div class="content-section">
            <h2>âš ï¸ æœ€ä½³å®è·µ</h2>
            <div class="warning-box">
                <strong>é…ç½®éªŒè¯ï¼š</strong> å§‹ç»ˆåœ¨å®éªŒå¼€å§‹å‰éªŒè¯é…ç½®æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œé¿å…é•¿æ—¶é—´è®­ç»ƒåå‘ç°é…ç½®é”™è¯¯ã€‚
            </div>
            
            <div class="info-box">
                <strong>å®éªŒè®°å½•ï¼š</strong> ä½¿ç”¨WandBæˆ–ç»“æœä¿å­˜åŠŸèƒ½è®°å½•æ‰€æœ‰å®éªŒï¼Œä¾¿äºåç»­åˆ†æå’Œæ¯”è¾ƒã€‚
            </div>
            
            <div class="warning-box">
                <strong>èµ„æºç®¡ç†ï¼š</strong> åˆç†è®¾ç½®æ‰¹å¤§å°å’Œå®¢æˆ·ç«¯æ•°é‡ï¼Œé¿å…å†…å­˜æº¢å‡ºæˆ–è®¡ç®—èµ„æºè€—å°½ã€‚
            </div>
            
            <div class="info-box">
                <strong>å¯é‡ç°æ€§ï¼š</strong> è®¾ç½®å›ºå®šçš„éšæœºç§å­ï¼Œç¡®ä¿å®éªŒç»“æœå¯é‡ç°ã€‚
            </div>
        </div>

        <div class="content-section">
            <h2>ğŸš€ æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
            <ul>
                <li><strong>å¹¶è¡Œå®éªŒï¼š</strong> ä½¿ç”¨å®éªŒè°ƒåº¦å™¨å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå®éªŒé…ç½®</li>
                <li><strong>é…ç½®ç¼“å­˜ï¼š</strong> ç¼“å­˜éªŒè¯è¿‡çš„é…ç½®ï¼Œé¿å…é‡å¤éªŒè¯å¼€é”€</li>
                <li><strong>å¢é‡ä¿å­˜ï¼š</strong> å®šæœŸä¿å­˜ä¸­é—´ç»“æœï¼Œé˜²æ­¢æ„å¤–ä¸­æ–­å¯¼è‡´æ•°æ®ä¸¢å¤±</li>
                <li><strong>å†…å­˜ç›‘æ§ï¼š</strong> ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŠæ—¶æ¸…ç†ä¸éœ€è¦çš„æ•°æ®</li>
                <li><strong>è®¾å¤‡ä¼˜åŒ–ï¼š</strong> å……åˆ†åˆ©ç”¨GPUåŠ é€Ÿï¼Œåˆç†åˆ†é…è®¡ç®—èµ„æº</li>
            </ul>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 è”é‚¦å­¦ä¹ æ¡†æ¶. æ‰€æœ‰æƒåˆ©ä¿ç•™.</p>
            <p><a href="models.html">ä¸Šä¸€é¡µï¼šModels æ¨¡å—</a> | <a href="index.html">è¿”å›é¦–é¡µ</a></p>
        </div>
    </footer>

    <script src="assets/script.js"></script>
</body>
</html>
